$(document).ready(function(){$("img.edit").on("click",e=>{var a=$(e.target).parents(".header")[0],t=$(a).next()[0];$(t).find("span.info").each((e,a)=>{0==$(a).parents(".password").length&&0==$(a).parents(".username").length&&0==$(a).parents(".email").length&&$(a).addClass("hidden")}),$(t).find(".input").each((e,a)=>{0==$(a).hasClass("fixed")&&$(a).removeClass("hidden")}),toggleButton(a,"edit",!1),toggleButton(a,"save",!0),toggleButton(a,"cancel",!0)}),$("img.cancel").on("click",e=>{var a=$(e.target).parents(".header")[0],t=$(a).next()[0];$(t).find(".input").each((e,a)=>{0==$(a).hasClass("fixed")&&$(a).addClass("hidden")}),$(t).find("span.info").each((e,a)=>{$(a).removeClass("hidden")}),$(a).find("img").addClass("hidden"),toggleButton(a,"edit",!0)}),$("img.save").on("click",e=>{var a=$(e.target).parents(".header")[0],t=$(a).next()[0],n=!1,d=!1,s=$(t).find(".input").each((e,a)=>{"file"==$(a).attr("type")?n=!0:d=!0});if($(a).find("img").addClass("hidden"),toggleButton(a,"loading",!0),1==d&&0==n){var i=$(s).serializeArray(),l=$(".cid").val();sendRequest("user/thong-tin-tai-khoan.html/"+l,"post",i,(e,n)=>{$(t).find(".input").each((e,a)=>{0==$(a).hasClass("fixed")&&$(a).addClass("hidden")}),$(t).find("span.info").each((e,a)=>{0==$(a).parents(".sex").length?$(a).text($(a).next(".input").val()):1==$(a).next(".input").val()?$(a).text("Ná»¯"):$(a).text("Nam"),$(a).removeClass("hidden")}),$(a).find("img").addClass("hidden"),toggleButton(a,"edit",!0)},(e,t,n)=>{$(a).find("img").addClass("hidden"),toggleButton(a,"error",!0),toggleButton(a,"cancel",!0)})}else if(0==d&&1==n){i=new FormData,l=$(".cid").val();i.append("avatar",$('input[type="file"]')[0].files[0]),sendRequest("user/thong-tin-tai-khoan.html/avatar/"+l,"post",i,(e,n)=>{var d=JSON.parse(e);1==d.status&&($(".avatar .fixed").removeClass("fixed"),0<$(".avatar img").length?$(".avatar img").attr("src",d.data.url):$(".avatar").append('<span class="info"><img src="'+d.data.url+'" style="max-width: 40px;"></span>'),$(t).find(".input").each((e,a)=>{$(a).addClass("hidden")}),$(t).find("span.info").each((e,a)=>{$(a).removeClass("hidden")})),$(a).find("img").addClass("hidden"),toggleButton(a,"edit",!0)},(e,t,n)=>{$(a).find("img").addClass("hidden"),toggleButton(a,"error",!0),toggleButton(a,"cancel",!0)})}})});var toggleButton=function(e,a,t=fasle){var n=$(e).find("."+a)[0];1==t?$(n).removeClass("hidden"):$(n).addClass("hidden")},sendRequest=function(e,a,t,n,d){var s=$(".base_url").val();$.ajax({url:s+e,method:a,contentType:!1,processData:!1,data:t,success:n,error:d})};